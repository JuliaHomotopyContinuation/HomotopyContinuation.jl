<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Path tracker · Homotopy Continuation</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="Homotopy Continuation logo"/></a><h1>Homotopy Continuation</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Introduction</a></li><li><a class="toctext" href="../solving/">Solving Polynomial Systems</a></li><li><a class="toctext" href="../systems/">Systems</a></li><li><a class="toctext" href="../homotopies/">Homotopies</a></li><li><a class="toctext" href="../predictors-correctors/">Predictors and Correctors</a></li><li class="current"><a class="toctext" href>Path tracker</a><ul class="internal"><li><a class="toctext" href="#Types-1">Types</a></li><li><a class="toctext" href="#Methods-1">Methods</a></li><li><a class="toctext" href="#Introspecting-the-current-state-1">Introspecting the current state</a></li><li><a class="toctext" href="#Changing-options-1">Changing options</a></li></ul></li><li><a class="toctext" href="../newton/">Newton&#39;s method</a></li><li><a class="toctext" href="../sorting/">Sorting arrays of solutions</a></li><li><a class="toctext" href="../norms_distances/">Norms and Distances</a></li><li><a class="toctext" href="../reference/">Reference</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Path tracker</a></li></ul><a class="edit-page" href="https://github.com/JuliaHomotopyContinuation/HomotopyContinuation.jl/blob/master/docs/src/pathtracking.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Path tracker</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Path-tracking-1" href="#Path-tracking-1">Path tracking</a></h1><p>We also export a path tracking primitive to make the core path tracking routine available for other applications. At the heart is a <a href="#HomotopyContinuation.PathTracker"><code>PathTracker</code></a> object which holds all the state. The easiest way to construct a <code>PathTracker</code> is to use the <a href="#HomotopyContinuation.pathtracker_startsolutions"><code>pathtracker_startsolutions</code></a> routine.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.pathtracker_startsolutions" href="#HomotopyContinuation.pathtracker_startsolutions"><code>HomotopyContinuation.pathtracker_startsolutions</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">pathtracker_startsolutions(args...; kwargs...)</code></pre><p>Construct a <a href="#HomotopyContinuation.PathTracker"><code>PathTracker</code></a> and <code>startsolutions</code> in the same way <code>solve</code> does it. This also takes the same input arguments as <code>solve</code>. This is convenient if you want to investigate single paths.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.pathtracker" href="#HomotopyContinuation.pathtracker"><code>HomotopyContinuation.pathtracker</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">pathtracker(args...; kwargs...)</code></pre><p>Construct a <a href="#HomotopyContinuation.PathTracker"><code>PathTracker</code></a> in the same way <code>solve</code> does it. This also takes the same input arguments as <code>solve</code> with the exception that you do not need to specify startsolutions. This is convenient if you want to investigate single paths.</p><p><strong>Examples</strong></p><p><strong>Obtain single solution</strong></p><p>We want to construct a path tracker to track a parameterized system <code>f</code> with parameters <code>p</code> from the parameters <code>a</code> to <code>b</code>.</p><pre><code class="language-julia">tracker = pathtracker(f, parameters=p, p₁=a, p₀=b)</code></pre><p>You then can obtain a single solution at <code>b</code> by using</p><pre><code class="language-julia">x_b = track(tracker, x_a).x</code></pre><p><strong>Trace a path</strong></p><p>To trace a path you can use the <a href="#HomotopyContinuation.iterator"><code>iterator</code></a> method.</p><pre><code class="language-julia">tracker = pathtracker(f, parameters=p, p₁=a, p₀=b, max_step_size =0.01)
for (x, t) in iterator(tracker, x₁)
    @show (x,t)
end</code></pre><p>If we want to guarantee smooth traces we can limit the maximal step size.</p><pre><code class="language-julia">tracker = pathtracker(f, parameters=p, p₁=a, p₀=b, max_step_size =0.01)
for (x, t) in iterator(tracker, x₁)
    @show (x,t)
end</code></pre></div></div></section><h2><a class="nav-anchor" id="Types-1" href="#Types-1">Types</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.PathTracker" href="#HomotopyContinuation.PathTracker"><code>HomotopyContinuation.PathTracker</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none"> PathTracker(H::AbstractHomotopy, x₁, t₁, t₀; options...)::PathTracker</code></pre><p>Create a <code>PathTracker</code> to track <code>x₁</code> from <code>t₁</code> to <code>t₀</code>. The homotopy <code>H</code> needs to be homogenous. Note that a <code>PathTracker</code> is also a (mutable) iterator.</p><p><strong>PathTrackerOptions</strong></p><ul><li><code>corrector::AbstractCorrector</code>: The corrector used during in the predictor-corrector scheme. The default is <a href="../predictors-correctors/#HomotopyContinuation.NewtonCorrector"><code>NewtonCorrector</code></a>.</li><li><code>max_corrector_iters=3</code>: The maximal number of correction steps in a single step.</li><li><code>initial_step_size=0.1</code>: The step size of the first step.</li><li><code>max_steps=10_000</code>: The maximal number of iterations the path tracker has available.</li><li><code>min_step_size =1e-14</code>: The minimal step size.</li><li><code>max_step_size =Inf</code>: The maximal step size.</li><li><code>maximal_lost_digits::Real=-(log₁₀(eps) + 3)</code>: The tracking is terminated if we estimate that we loose more than <code>maximal_lost_digits</code> in the linear algebra steps.</li><li><code>predictor::AbstractPredictor</code>: The predictor used during in the predictor-corrector scheme. The default is <a href="../predictors-correctors/#HomotopyContinuation.Heun"><code>Heun</code></a>()`.</li><li><code>refinement_max_iters=max_corrector_iters</code>: The maximal number of correction steps used to refine the final value.</li><li><code>refinement_accuracy=1e-8</code>: The precision used to refine the final value.</li><li><code>accuracy=1e-7</code>: The precision used to track a value.</li><li><code>auto_scaling=true</code>: This only applies if we track in affine space. Automatically regauges the variables to effectively compute with a relative accuracy instead of an absolute one.</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.PathTrackerResult" href="#HomotopyContinuation.PathTrackerResult"><code>HomotopyContinuation.PathTrackerResult</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none"> PathTrackerResult{V&lt;:AbstractVector}</code></pre><p>Containing the result of a tracked path. The fields are</p><ul><li><code>returncode::PathTrackerStatus.states</code> If the tracking was successfull then it is <code>PathTrackerStatus.success</code>.</li><li><code>x::V</code> The result.</li><li><code>t::ComplexF64</code> The <code>t</code> when the path tracker stopped.</li><li><code>accuracy::Float64</code>: The estimated accuracy of <code>x</code>.</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.PathTrackerStatus.states" href="#HomotopyContinuation.PathTrackerStatus.states"><code>HomotopyContinuation.PathTrackerStatus.states</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">PathTrackerStatus.states</code></pre><p>The possible states the pathtracker can achieve are</p><ul><li><code>PathTrackerStatus.success</code></li><li><code>PathTrackerStatus.tracking</code></li><li><code>PathTrackerStatus.terminated_maximal_iterations</code></li><li><code>PathTrackerStatus.terminated_invalid_startvalue</code></li><li><code>PathTrackerStatus.terminated_step_size_too_small</code></li><li><code>PathTrackerStatus.terminated_singularity</code></li><li><code>PathTrackerStatus.terminated_ill_conditioned</code></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaLang/julia/blob/099e826241fca365a120df9bac9a9fede6e7bae4/base/#L0-L12">source</a></section><h2><a class="nav-anchor" id="Methods-1" href="#Methods-1">Methods</a></h2><p>To track from a start to an endpoint with the <code>PathTracker</code> we provide the following routines.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.track" href="#HomotopyContinuation.track"><code>HomotopyContinuation.track</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">track(tracker, x₁, t₁=1.0, t₀=0.0; options...)::PathTrackerResult</code></pre><p>Track a value <code>x₁</code> from <code>t₁</code> to <code>t₀</code> using the given <code>PathTracker</code> <code>tracker</code>. This returns a <code>PathTrackerResult</code>. This modifies <code>tracker</code>. See <a href="#HomotopyContinuation.track!"><code>track!</code></a> for the possible options.</p></div></div><div><div><pre><code class="language-none">track(tracker, x::AbstractVector, edge::Edge, loop::Loop, stats::MonodromyStatistics)</code></pre><p>Track <code>x</code> along the edge <code>edge</code> in the loop <code>loop</code> using <code>tracker</code>. Record statistics in <code>stats</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.track!" href="#HomotopyContinuation.track!"><code>HomotopyContinuation.track!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> track!(tracker, x₁, t₁=1.0, t₀=0.0; setup_patch=true, checkstartvalue=true, compute_ẋ=true)</code></pre><p>Track a value <code>x₁</code> from <code>t₁</code> to <code>t₀</code> using the given <code>PathTracker</code> <code>tracker</code>. Returns one of the enum values of <code>PathTrackerStatus.states</code> indicating the status. If the tracking was successfull it is <code>PathTrackerStatus.success</code>. If <code>setup_patch</code> is <code>true</code> then <a href="#HomotopyContinuation.setup!"><code>setup!</code></a> is called at the beginning of the tracking.</p><pre><code class="language-none">track!(x₀, tracker, x₁, t₁=1.0, t₀=0.0; options...)</code></pre><p>Additionally also stores the result in <code>x₀</code> if the tracking was successfull.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.setup!" href="#HomotopyContinuation.setup!"><code>HomotopyContinuation.setup!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">setup!(::AbstractAffinePatchState, x::AbstractVector)</code></pre><p>Setup the affine patch depending on <code>x</code> and modify <code>x</code> if necessary. This is only called once at the beginning of a tracked path.</p></div></div><div><div><pre><code class="language-none">setup!(cache::AbstractStatefulPredictorCache, H, x, ẋ, t, fac)</code></pre><p>Setup the cache. <code>x</code> is the new path value at <code>t</code> and <code>ẋ</code> is the derivative at <code>t</code>. <code>fac</code> is a factorization of the Jacobian at <code>(x,t)</code>. This falls back to calling <code>update</code>.</p></div></div><div><div><pre><code class="language-none">setup!(pathtracker, x₁, t₁=1.0, t₀=0.0, setup_patch=pathtracker.options.update_patch, checkstartvalue=true, compute_ẋ=true)</code></pre><p>Setup <code>pathtracker</code> to track <code>x₁</code> from <code>t₁</code> to <code>t₀</code>. Use this if you want to use the pathtracker as an iterator.</p></div></div></section><p>It is also possible to use a <code>PathTracker</code> as an iterator. This can either be done by the high level <code>iterator</code> method or by directly using a <code>PathTracker</code> as an iterator. The recommend approach is simply using <code>iterator</code>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.iterator" href="#HomotopyContinuation.iterator"><code>HomotopyContinuation.iterator</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">iterator(tracker::PathTracker, x₁, t₁=1.0, t₀=0.0; affine=true)</code></pre><p>Prepare a tracker to make it usable as a (stateful) iterator. Use this if you want to inspect a specific path. In each iteration the tuple <code>(x,t)</code> is returned. If <code>affine == true</code> then <code>x</code> is the affine solution (internally we compute in projective space).</p><p><strong>Example</strong></p><p>Assume you have <code>PathTracker</code> <code>tracker</code> and you wan to track <code>x₁</code> from 1.0 to 0.25:</p><pre><code class="language-julia">for (x,t) in iterator(tracker, x₁, 1.0, 0.25)
    println(&quot;x at t=$t:&quot;)
    println(x)
end</code></pre><p>Note that this is a stateful iterator. You can still introspect the state of the tracker. For example to check whether the tracker was successfull (and did not terminate early due to some problem) you can do</p><pre><code class="language-julia">println(&quot;Success: &quot;, currstatus(tracker) == PathTrackerStatus.success)</code></pre></div></div></section><h2><a class="nav-anchor" id="Introspecting-the-current-state-1" href="#Introspecting-the-current-state-1">Introspecting the current state</a></h2><p>To introspect the current state we provide the following routines.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.currx" href="#HomotopyContinuation.currx"><code>HomotopyContinuation.currx</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">currx(tracker::PathTracker)</code></pre><p>Return the current value of <code>x</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.currt" href="#HomotopyContinuation.currt"><code>HomotopyContinuation.currt</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> currt(tracker::PathTracker)</code></pre><p>Current <code>t</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.currΔt" href="#HomotopyContinuation.currΔt"><code>HomotopyContinuation.currΔt</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> currΔt(tracker::PathTracker)</code></pre><p>Current step_size <code>Δt</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.curriters" href="#HomotopyContinuation.curriters"><code>HomotopyContinuation.curriters</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> curriters(tracker::PathTracker)</code></pre><p>Current number of iterations.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.currstatus" href="#HomotopyContinuation.currstatus"><code>HomotopyContinuation.currstatus</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> currstatus(tracker::PathTracker)</code></pre><p>Current status.</p></div></div></section><h2><a class="nav-anchor" id="Changing-options-1" href="#Changing-options-1">Changing options</a></h2><p>To change settings</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.accuracy" href="#HomotopyContinuation.accuracy"><code>HomotopyContinuation.accuracy</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> accuracy(tracker::PathTracker)</code></pre><p>Current accuracy.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.set_accuracy!" href="#HomotopyContinuation.set_accuracy!"><code>HomotopyContinuation.set_accuracy!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> set_accuracy!(tracker::PathTracker, accuracy)</code></pre><p>Set the current accuracy to <code>accuracy</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.max_corrector_iters" href="#HomotopyContinuation.max_corrector_iters"><code>HomotopyContinuation.max_corrector_iters</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> max_corrector_iters(tracker::PathTracker)</code></pre><p>Current correction max_steps.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.set_max_corrector_iters!" href="#HomotopyContinuation.set_max_corrector_iters!"><code>HomotopyContinuation.set_max_corrector_iters!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> set_max_corrector_iters!(tracker::PathTracker, n)</code></pre><p>Set the correction max_steps to <code>n</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.max_step_size" href="#HomotopyContinuation.max_step_size"><code>HomotopyContinuation.max_step_size</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> max_step_size (tracker::PathTracker)</code></pre><p>Current maximal step size.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.set_max_step_size!" href="#HomotopyContinuation.set_max_step_size!"><code>HomotopyContinuation.set_max_step_size!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> set_max_corrector_iters!(tracker::PathTracker, Δs)</code></pre><p>Set the maximal step size to <code>Δs</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.refinement_max_iters" href="#HomotopyContinuation.refinement_max_iters"><code>HomotopyContinuation.refinement_max_iters</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> refinement_max_iters(tracker::PathTracker)</code></pre><p>Current refinement max_steps.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.set_refinement_max_iters!" href="#HomotopyContinuation.set_refinement_max_iters!"><code>HomotopyContinuation.set_refinement_max_iters!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> set_refinement_max_iters!(tracker::PathTracker, n)</code></pre><p>Set the current refinement max_steps to <code>n</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.refinement_accuracy" href="#HomotopyContinuation.refinement_accuracy"><code>HomotopyContinuation.refinement_accuracy</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> refinement_accuracy(tracker::PathTracker)</code></pre><p>Current refinement accuracy.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.set_refinement_accuracy!" href="#HomotopyContinuation.set_refinement_accuracy!"><code>HomotopyContinuation.set_refinement_accuracy!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> set_refinement_max_iters!(tracker::PathTracker, accuracy)</code></pre><p>Set the current refinement accuracy to <code>accuracy</code>.</p></div></div></section><footer><hr/><a class="previous" href="../predictors-correctors/"><span class="direction">Previous</span><span class="title">Predictors and Correctors</span></a><a class="next" href="../newton/"><span class="direction">Next</span><span class="title">Newton&#39;s method</span></a></footer></article></body></html>
